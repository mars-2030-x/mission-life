<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Life — Plan, Focus, Reflect</title>
    <meta name="description" content="미션 기반 습관 변화 시스템. 일간/주간/월간 미션을 게임처럼 관리하고 명상으로 마음을 정화하세요.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Aurora Background -->
    <div class="aurora-bg">
        <div class="aurora-blob aurora-1"></div>
        <div class="aurora-blob aurora-2"></div>
        <div class="aurora-blob aurora-3"></div>
    </div>

    <!-- Liquid SVG Filter -->
    <svg style="position: absolute; width: 0; height: 0;" aria-hidden="true">
        <defs>
            <filter id="liquid-filter">
                <feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />
                <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9"
                    result="liquid" />
                <feBlend in="SourceGraphic" in2="liquid" />
            </filter>
        </defs>
    </svg>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span class="logo-icon">ML</span>
                <span class="logo-text">Mission Life</span>
            </div>
        </div>
        <ul class="nav-list">
            <li class="nav-item active" data-page="dashboard">
                <span class="nav-icon">•</span>
                <span class="nav-label">대시보드</span>
            </li>
            <li class="nav-item" data-page="plan">
                <span class="nav-icon">•</span>
                <span class="nav-label">계획</span>
            </li>
            <li class="nav-item" data-page="today">
                <span class="nav-icon">•</span>
                <span class="nav-label">오늘의 미션</span>
            </li>
            <li class="nav-item" data-page="meditation">
                <span class="nav-icon">•</span>
                <span class="nav-label">명상</span>
            </li>
            <li class="nav-item" data-page="stats">
                <span class="nav-icon">•</span>
                <span class="nav-label">통계</span>
            </li>
        </ul>
        <div class="sidebar-footer">
            <div class="user-level" id="sidebarLevel">
                <div class="level-badge">Lv.1</div>
                <span class="level-title">초심자</span>
            </div>
        </div>
    </nav>

    <!-- Mobile Bottom Tab Bar -->
    <nav class="bottom-tab" id="bottomTab">
        <div class="tab-item active" data-page="dashboard">
            <span class="tab-icon">홈</span>
            <span class="tab-label">홈</span>
        </div>
        <div class="tab-item" data-page="plan">
            <span class="tab-icon">계획</span>
            <span class="tab-label">계획</span>
        </div>
        <div class="tab-item" data-page="today">
            <span class="tab-icon">미션</span>
            <span class="tab-label">미션</span>
        </div>
        <div class="tab-item" data-page="meditation">
            <span class="tab-icon">명상</span>
            <span class="tab-label">명상</span>
        </div>
        <div class="tab-item" data-page="stats">
            <span class="tab-icon">통계</span>
            <span class="tab-label">통계</span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard Page -->
        <section class="page" id="page-dashboard">
            <div class="page-header">
                <h1>대시보드</h1>
                <p class="page-subtitle" id="dashboardDate"></p>
            </div>
            <div class="dashboard-grid">
                <div class="card card-today" id="todayCard">
                    <div class="card-label">오늘 카드</div>
                    <div id="todayCardContent"></div>
                </div>
                <div class="card card-level" id="levelCard">
                    <div class="card-glow"></div>
                    <div class="level-info">
                        <div class="level-number" id="dashLevel">1</div>
                        <div class="level-name" id="dashLevelName">초심자</div>
                    </div>
                    <div class="exp-bar-container">
                        <div class="exp-bar">
                            <div class="exp-bar-fill" id="dashExpBar" style="width:0%"></div>
                        </div>
                        <span class="exp-text" id="dashExpText">0 / 100 EXP</span>
                    </div>
                </div>
                <div class="card card-streak" id="streakCard">
                    <div class="card-label">연속 달성</div>
                    <div class="streak-number" id="dashStreak">0</div>
                    <div class="streak-sub">일 연속</div>
                </div>
                <div class="card card-progress" id="progressCard">
                    <div class="card-label">오늘 달성률</div>
                    <canvas id="progressCanvas" width="140" height="140"></canvas>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
                <div class="card card-next" id="nextMissionCard">
                    <div class="card-label">다음 미션</div>
                    <div class="next-mission-info" id="nextMissionInfo">
                        <p class="next-mission-empty">미션이 없습니다</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Plan Page -->
        <section class="page hidden" id="page-plan">
            <div class="page-header">
                <h1>계획 수립</h1>
                <p class="page-subtitle">월간 목표를 주간·일간 미션으로 세분화하세요</p>
            </div>
            <div class="plan-container">
                <div class="plan-column">
                    <div class="plan-column-header">
                        <h2>🏰 보스 미션 <span class="plan-period">Boss Mission (월간)</span></h2>
                        <button class="btn-add" id="addBossMission">+ 추가</button>
                    </div>
                    <div class="plan-list" id="bossMissionList"></div>
                </div>
                <div class="plan-column">
                    <div class="plan-column-header">
                        <h2>📖 챕터 미션 <span class="plan-period">Chapter Mission (주간)</span></h2>
                        <button class="btn-add" id="addChapterMission">+ 추가</button>
                    </div>
                    <div class="plan-list" id="chapterMissionList"></div>
                </div>
                <div class="plan-column">
                    <div class="plan-column-header">
                        <h2>⚡ 데일리 퀘스트 <span class="plan-period">Daily Quest (일간)</span></h2>
                        <button class="btn-add" id="addDailyQuest">+ 추가</button>
                    </div>
                    <div class="plan-list" id="dailyQuestList"></div>
                </div>
            </div>
        </section>

        <!-- Today Mission Page -->
        <section class="page hidden" id="page-today">
            <div class="page-header">
                <h1>오늘의 미션</h1>
                <p class="page-subtitle" id="todayDate"></p>
            </div>
            <div class="today-container" id="todayMissionList">
                <div class="empty-state">
                    <div class="empty-icon">⚔️</div>
                    <p>오늘 수행할 데일리 퀘스트가 없습니다.</p>
                    <button class="btn-primary" onclick="location.hash='#plan'">계획 페이지에서 미션 추가</button>
                </div>
            </div>
        </section>

        <!-- Meditation Page -->
        <section class="page hidden" id="page-meditation">
            <div class="page-header">
                <h1>명상</h1>
                <p class="page-subtitle">마음을 고요하게, 무의식을 정화하세요</p>
            </div>
            <div class="meditation-container">
                <div class="meditation-timer-area">
                    <div class="timer-circle-wrap">
                        <svg class="timer-svg" viewBox="0 0 200 200">
                            <circle class="timer-bg" cx="100" cy="100" r="90" />
                            <circle class="timer-progress" id="timerProgress" cx="100" cy="100" r="90" />
                        </svg>
                        <div class="timer-display" id="timerDisplay">05:00</div>
                    </div>
                    <div class="timer-duration-select" id="timerDurationSelect">
                        <button class="dur-btn" data-min="2">2분</button>
                        <button class="dur-btn active" data-min="5">5분</button>
                        <button class="dur-btn" data-min="10">10분</button>
                        <button class="dur-btn" data-min="20">20분</button>
                        <button class="dur-btn" data-min="0">자유</button>
                    </div>
                    <div class="timer-type-select" id="timerTypeSelect">
                        <button class="type-btn active" data-type="breath">호흡 관찰</button>
                        <button class="type-btn" data-type="bodyscan">바디스캔</button>
                        <button class="type-btn" data-type="loving">자애 명상</button>
                        <button class="type-btn" data-type="silent">무음</button>
                    </div>
                    <div class="timer-controls">
                        <button class="btn-timer-start" id="btnMeditationStart">시작</button>
                        <button class="btn-timer-pause hidden" id="btnMeditationPause">일시정지</button>
                        <button class="btn-timer-stop hidden" id="btnMeditationStop">종료</button>
                    </div>
                </div>
                <div class="meditation-stats-card card">
                    <h3>명상 기록</h3>
                    <div class="med-stat-row">
                        <span>총 명상 시간</span>
                        <strong id="medTotalTime">0분</strong>
                    </div>
                    <div class="med-stat-row">
                        <span>연속 명상 일수</span>
                        <strong id="medStreak">0일</strong>
                    </div>
                    <div class="med-stat-row">
                        <span>마음 레벨</span>
                        <strong id="medLevel">수련생</strong>
                    </div>
                </div>
            </div>
            <!-- Meditation After Modal -->
            <div class="modal-overlay hidden" id="meditationAfterModal">
                <div class="modal">
                    <h2>명상 완료</h2>
                    <p class="med-complete-duration" id="medCompleteDuration"></p>
                    <div class="focus-rating" id="focusRating">
                        <p>집중도 평가</p>
                        <div class="stars">
                            <span class="star" data-val="1">★</span>
                            <span class="star" data-val="2">★</span>
                            <span class="star" data-val="3">★</span>
                            <span class="star" data-val="4">★</span>
                            <span class="star" data-val="5">★</span>
                        </div>
                    </div>
                    <textarea id="medMemo" class="med-memo" placeholder="명상 기록 한 줄(선택)을 적어보세요..."></textarea>
                    <button class="btn-primary" id="btnSaveMeditation">저장</button>
                </div>
            </div>
        </section>

        <!-- Stats Page -->
        <section class="page hidden" id="page-stats">
            <div class="page-header">
                <h1>통계</h1>
                <p class="page-subtitle">나의 성장 기록</p>
            </div>
            <div class="stats-grid">
                <div class="card stats-heatmap-card">
                    <h3>주간 달성률</h3>
                    <div class="heatmap" id="weeklyHeatmap"></div>
                    <div id="weeklyStatsCta"></div>
                </div>
                <div class="card stats-chart-card">
                    <h3>월간 성장 그래프</h3>
                    <canvas id="monthlyChart" width="600" height="250"></canvas>
                    <div id="monthlyChartCta"></div>
                </div>
                <div class="card stats-meditation-card">
                    <h3>명상 누적 통계</h3>
                    <div class="med-stats-detail" id="medStatsDetail"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Mission Create/Edit Modal -->
    <div class="modal-overlay hidden" id="missionModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="missionModalTitle">미션 생성</h2>
                <button class="modal-close" id="missionModalClose">&times;</button>
            </div>
            <form id="missionForm">
                <input type="hidden" id="missionId">
                <div class="form-group">
                    <label for="missionTitle">미션 제목</label>
                    <input type="text" id="missionTitle" placeholder="미션 제목을 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="missionType">유형</label>
                    <select id="missionType">
                        <option value="boss">🏰 보스 미션 (월간)</option>
                        <option value="chapter">📖 챕터 미션 (주간)</option>
                        <option value="daily">⚡ 데일리 퀘스트 (일간)</option>
                    </select>
                </div>
                <div class="form-group" id="parentMissionGroup">
                    <label for="parentMission">상위 미션 연결</label>
                    <select id="parentMission">
                        <option value="">없음</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="missionDifficulty">난이도</label>
                        <select id="missionDifficulty">
                            <option value="1">⭐ 쉬움</option>
                            <option value="2" selected>⭐⭐ 보통</option>
                            <option value="3">⭐⭐⭐ 어려움</option>
                            <option value="4">⭐⭐⭐⭐ 도전</option>
                            <option value="5">⭐⭐⭐⭐⭐ 극한</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="missionMinutes">예상 시간 (분)</label>
                        <input type="number" id="missionMinutes" value="30" min="5" max="480">
                    </div>
                </div>
                <div class="form-group" id="scheduleGroup">
                    <label for="missionTime">수행 시간</label>
                    <input type="time" id="missionTime" value="09:00">
                </div>
                <div class="form-group" id="repeatGroup">
                    <label>반복 요일</label>
                    <div class="repeat-days" id="repeatDays">
                        <label class="day-check"><input type="checkbox" value="0"><span>일</span></label>
                        <label class="day-check"><input type="checkbox" value="1" checked><span>월</span></label>
                        <label class="day-check"><input type="checkbox" value="2" checked><span>화</span></label>
                        <label class="day-check"><input type="checkbox" value="3" checked><span>수</span></label>
                        <label class="day-check"><input type="checkbox" value="4" checked><span>목</span></label>
                        <label class="day-check"><input type="checkbox" value="5" checked><span>금</span></label>
                        <label class="day-check"><input type="checkbox" value="6"><span>토</span></label>
                    </div>
                </div>
                <button type="submit" class="btn-primary">저장</button>
            </form>
        </div>
    </div>

    <div class="fab-wrap">
        <button class="fab-main" id="quickFab">＋</button>
        <div class="fab-menu hidden" id="quickFabMenu">
            <button class="fab-action" data-action="add-daily">데일리 퀘스트 추가</button>
            <button class="fab-action" data-action="start-meditation">명상 시작</button>
            <button class="fab-action" data-action="add-record">기록 남기기</button>
        </div>
    </div>

    <!-- Level Up Overlay -->
    <div class="levelup-overlay hidden" id="levelUpOverlay">
        <div class="levelup-content">
            <div class="levelup-icon">🎉</div>
            <h2>LEVEL UP!</h2>
            <div class="levelup-level" id="levelUpLevel"></div>
            <div class="levelup-title" id="levelUpTitle"></div>
            <button class="btn-primary" id="levelUpClose">확인</button>
        </div>
        <div class="particles" id="particles"></div>
    </div>

    <!-- Onboarding -->
    <div class="modal-overlay hidden" id="onboardingModal">
        <div class="modal onboarding-modal">
            <div class="onboarding-icon"></div>
            <h2>Mission Life에 오신 걸 환영합니다!</h2>
            <p>습관 변화와 무의식 정화를 위한 여정을 시작하세요.</p>
            <ul class="onboarding-steps">
                <li>월간 보스 미션으로 큰 목표를 세우세요</li>
                <li>주간 챕터로 단계를 나누세요</li>
                <li>데일리 퀘스트로 매일 실천하세요</li>
                <li>명상으로 마음을 돌보세요</li>
            </ul>
            <button class="btn-primary" id="onboardingStart">시작하기</button>
        </div>
    </div>

    <script src="js/store.js"></script>
    <script src="js/gamification.js"></script>
    <script src="js/missions.js"></script>
    <script src="js/meditation.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>

</html>
